# ONA Health - Pneumonia Head Test Set Evaluation

**Generated:** 2026-02-09 15:12
**Model:** MultiHeadClassifier (DenseNet121 backbone, TB + Pneumonia heads)
**Dataset:** Chest X-Ray Images (Pneumonia) - Pediatric (5856 images)
**Test set:** 587 images (428 Pneumonia, 159 Normal)
**Epochs trained:** 6

> **IMPORTANT:** This dataset contains pediatric chest X-rays (children aged 1-5).
> Results validate the multi-head architecture. Population-specific fine-tuning
> on adult African cohort data is a funded objective of this proposal.

---

## Test Set Results (Pneumonia Head)

| Metric | Value | 95% CI |
|--------|-------|--------|
| **Sensitivity** | 94.2% | 91.8% - 96.4% |
| **Specificity** | 95.6% | 92.1% - 98.6% |
| **AUC-ROC** | 0.9817 | 0.9723 - 0.9896 |
| **Optimal Threshold** | 0.625 | - |

## Confusion Matrix (threshold = 0.625, n=587)

|  | Predicted Pneumonia | Predicted Normal |
|--|---------------------|------------------|
| **Actual Pneumonia** | 403 | 25 |
| **Actual Normal** | 7 | 152 |

## Score Distribution

- **Pneumonia** (n=428): mean=0.930, range=[0.024, 1.000]
- **Normal** (n=159): mean=0.179, range=[0.002, 0.942]
- **Separation:** 0.751

## Overfitting Check

- Validation sensitivity: 94.4%
- Test sensitivity: 94.2%
- Drop: 0.2%

## Training History

| Epoch | Train Loss | Train Acc | Val AUC | Val Sens | Val Spec |
|-------|-----------|-----------|---------|----------|----------|
| 1 | 0.2475 | 89.6% | 0.985 | 95.3% | 94.9% |
| 2 | 0.2079 | 91.8% | 0.985 | 95.6% | 94.3% |
| 3 | 0.2007 | 92.0% | 0.987 | 95.6% | 95.6% |
| 4 | 0.1918 | 92.1% | 0.986 | 95.8% | 94.9% |
| 5 | 0.1839 | 92.9% | 0.985 | 96.7% | 93.0% |
| 6 | 0.1836 | 92.5% | 0.988 | 94.4% | 96.8% |

---

## Combined Model Summary (Both Heads)

| Head | AUC | Sensitivity | 95% CI Sens | Specificity | 95% CI Spec | Dataset |
|------|-----|-------------|-------------|-------------|-------------|---------|
| **TB** | 0.9985 | 98.6% | 95.3-100% | 98.3% | 96.8-99.4% | Adult TB CXR (4,200) |
| **Pneumonia** | 0.9817 | 94.2% | 91.8%-96.4% | 95.6% | 92.1%-98.6% | Pediatric CXR (5856) |

## For Grant Applications

> "ONA Health's multi-head AI architecture uses a shared DenseNet121 backbone
> with independent classification heads for TB and pneumonia detection.
> The TB head achieved 99% sensitivity (95% CI: 95-100%) on adult chest
> radiographs. The pneumonia head achieved 94% sensitivity
> (95% CI: 92%-96%) on a pediatric validation dataset,
> confirming architectural scalability. Population-specific fine-tuning on adult
> African cohort data is a funded objective of this proposal."

---

*Model saved to: data\models\ona-multihead-finetuned.pth*
*Report generated by ONA Edge Pneumonia Evaluation Tool v1.0*
