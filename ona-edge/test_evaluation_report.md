# ONA Health - Fine-Tuning Results

**Generated:** 2026-02-09 04:18
**Model:** DenseNet121 fine-tuned for TB detection
**Backbone:** TorchXRayVision densenet121-res224-all
**Dataset:** TB_Chest_Radiography_Database (4200 images)
**Split:** 3360 train / 420 val / 420 test
**Training time:** 257s (10 epochs)

---

## Results: Baseline vs Fine-Tuned

| Metric | Baseline (zero-shot) | Fine-Tuned | WHO Target | Status |
|--------|---------------------|------------|------------|--------|
| **Sensitivity** | 72.3% | **98.6%** (95% CI: 95.2%-100.0%) | >90% | MEETS |
| **Specificity** | 85.0% | **98.3%** (95% CI: 96.8%-99.4%) | >70% | MEETS |
| **AUC-ROC** | 0.824 | **0.998** (95% CI: 0.996-1.000) | >0.85 | MEETS |
| **Optimal Threshold** | 0.63 | 0.180 | - | - |

**WHO TPP:** Sensitivity MEETS / Specificity MEETS

---

## Test Set Confusion Matrix (threshold = 0.180)

```
                      Predicted
                 |  TB     |  Normal  |
Actual    TB     |     69  |      1   |
        Normal   |      6  |    344   |
```

- **True Positives:** 69 (correctly detected TB)
- **True Negatives:** 344 (correctly cleared healthy)
- **False Positives:** 6 (healthy flagged as TB)
- **False Negatives:** 1 (TB missed)

---

## Score Distribution (Test Set)

**TB Positive** (n=70):
- Mean: 0.911, Range: [0.091, 1.000]

**Normal** (n=350):
- Mean: 0.024, Range: [0.000, 0.610]

**Separation:** 0.887 (baseline was 0.042)

---

## Training History

| Epoch | Train Loss | Train Acc | Val Loss | Val AUC | Val Sens | Val Spec |
|-------|-----------|-----------|----------|---------|----------|----------|
| 1 | 0.6641 | 83.0% | 0.3080 | 0.986 | 95.7% | 91.7% |
| 2 | 0.4957 | 88.6% | 0.2880 | 0.993 | 97.1% | 97.7% |
| 3 | 0.5004 | 87.9% | 0.2598 | 0.993 | 95.7% | 98.3% |
| 4 | 0.4386 | 89.6% | 0.1524 | 0.994 | 97.1% | 98.6% |
| 5 | 0.3380 | 92.2% | 0.1476 | 0.995 | 97.1% | 99.1% |
| 6 | 0.3144 | 93.7% | 0.1469 | 0.995 | 98.6% | 98.0% |
| 7 | 0.3061 | 93.9% | 0.1585 | 0.996 | 98.6% | 99.1% |
| 8 | 0.3091 | 93.1% | 0.1299 | 0.995 | 98.6% | 98.3% |
| 9 | 0.2850 | 94.4% | 0.1312 | 0.996 | 98.6% | 98.6% |
| 10 | 0.2596 | 95.3% | 0.1177 | 0.996 | 98.6% | 98.9% |

---

## Configuration

- **Backbone:** DenseNet121 pretrained on CheXpert, MIMIC, NIH, PadChest
- **Classifier:** Dropout(0.3) + Linear(1024,256) + ReLU + Dropout(0.2) + Linear(256,1)
- **Optimizer:** Adam (lr=0.001)
- **Scheduler:** Cosine annealing
- **Augmentation:** horizontal flip, rotation +/-10deg, brightness, contrast
- **Class weight:** 5.0x for TB positive (compensating 3500:700 imbalance)
- **Early stopping:** patience 7 on val AUC
- **Backbone unfrozen at epoch:** 5

---

## For Grant Applications

> "After transfer learning on 4200 labeled chest radiographs, ONA Health's AI system achieved **99% sensitivity (95% CI: 95%-100%)** and **98% specificity (95% CI: 97%-99%)** for TB detection, with an AUC-ROC of **1.00 (95% CI: 1.00-1.00)**. This represents improvement over the zero-shot baseline (AUC 0.824), validating the transfer learning approach for deployment in resource-limited settings."

---

*Model saved to: data\models\ona-tb-finetuned.pth*
*Report generated by ONA Edge Fine-Tuning Tool v1.0*
